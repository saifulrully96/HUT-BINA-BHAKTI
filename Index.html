<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Twibbon Generator</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>Twibbon Ulang Tahun Desa Bina Bhakti ke-32</h1>

        <!-- 1. Upload Photo -->
        <div class="section">
            <label for="uploadPhoto">1. Upload Foto:</label>
            <input type="file" id="uploadPhoto" accept="image/*">
        </div>

        <!-- 2. Enter Name -->
        <div class="section">
            <label for="inputName">2. Tulis Nama:</label>
            <input type="text" id="inputName" placeholder="Masukkan Nama">
            <label for="fontSelect">Jenis Font:</label>
            <select id="fontSelect">
                <option value="Arial">Arial</option>
                <option value="Verdana">Verdana</option>
                <option value="Times New Roman">Times New Roman</option>
            </select>
            <label for="colorSelect">Warna Teks:</label>
            <input type="color" id="colorSelect" value="#000000">
        </div>

        <!-- 3. Design Twibbon -->
        <div class="canvas-container">
            <h2>3. Desain Twibbon:</h2>
            <canvas id="twibbonCanvas" width="1080" height="1080"></canvas>
        </div>

        <!-- 4. Controls for adjusting text position -->
        <div class="controls">
            <label>4. Atur Posisi Nama:</label>
            <button onclick="moveText('up')">&#8593;</button> <!-- Atas -->
            <button onclick="moveText('down')">&#8595;</button> <!-- Bawah -->
            <button onclick="moveText('left')">&#8592;</button> <!-- Kiri -->
            <button onclick="moveText('right')">&#8594;</button> <!-- Kanan -->
        </div>

        <!-- 5. Controls for adjusting image size and position -->
        <div class="controls">
            <label>5. Atur Ukuran dan Posisi Foto:</label>
            <button onclick="resizeImage('increase')">&#x2795;</button> <!-- Perbesar -->
            <button onclick="resizeImage('decrease')">&#x2796;</button> <!-- Perkecil -->
            <button onclick="moveImage('up')">&#8593;</button> <!-- Atas -->
            <button onclick="moveImage('down')">&#8595;</button> <!-- Bawah -->
            <button onclick="moveImage('left')">&#8592;</button> <!-- Kiri -->
            <button onclick="moveImage('right')">&#8594;</button> <!-- Kanan -->
        </div>

        <!-- Download Button -->
        <button onclick="downloadImage()">Download Twibbon</button>
    </div>

    <script>
        const canvas = document.getElementById('twibbonCanvas');
        const ctx = canvas.getContext('2d');
        let img = new Image();
        let imgWidth = 200;
        let imgHeight = 200;
        let imgX = (canvas.width - imgWidth) / 2;
        let imgY = (canvas.height - imgHeight) / 2;
        let textX = canvas.width / 2;
        let textY = canvas.height / 2;
        let currentFont = 'Arial';
        let currentColor = '#000000';

        // Muat template Twibbon
        const twibbonImage = new Image();
        twibbonImage.crossOrigin = "Anonymous";
        twibbonImage.src = 'twibbon.png';
        twibbonImage.onload = () => {
            draw();
        };

        // Mengupload foto
        document.getElementById('uploadPhoto').addEventListener('change', function(e) {
            const reader = new FileReader();
            reader.onload = function(event) {
                img = new Image();
                img.onload = function() {
                    imgWidth = 200;
                    imgHeight = 200;
                    imgX = (canvas.width - imgWidth) / 2;
                    imgY = (canvas.height - imgHeight) / 2;
                    draw();
                }
                img.src = event.target.result;
            }
            reader.readAsDataURL(e.target.files[0]);
        });

        // Menggambar canvas
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            if (twibbonImage.complete) {
                ctx.drawImage(twibbonImage, 0, 0, canvas.width, canvas.height);
            }
            if (img.complete) {
                ctx.drawImage(img, imgX, imgY, imgWidth, imgHeight);
            }
            ctx.font = `40px ${currentFont}`;
            ctx.fillStyle = currentColor;
            ctx.textAlign = 'center';
            ctx.fillText(document.getElementById('inputName').value, textX, textY);
        }

        // Menggerakkan teks
        function moveText(direction) {
            const step = 5;
            switch (direction) {
                case 'up': textY -= step; break;
                case 'down': textY += step; break;
                case 'left': textX -= step; break;
                case 'right': textX += step; break;
            }
            draw();
        }

        // Mengubah ukuran gambar
        function resizeImage(action) {
            const resizeStep = 10;
            if (action === 'increase') {
                imgWidth += resizeStep;
                imgHeight += resizeStep;
            } else if (action === 'decrease') {
                imgWidth = Math.max(imgWidth - resizeStep, 10);
                imgHeight = Math.max(imgHeight - resizeStep, 10);
            }
            draw();
        }

        // Menggerakkan gambar
        function moveImage(direction) {
            const step = 5;
            switch (direction) {
                case 'up': imgY -= step; break;
                case 'down': imgY += step; break;
                case 'left': imgX -= step; break;
                case 'right': imgX += step; break;
            }
            draw();
        }

        // Mengubah jenis font
        document.getElementById('fontSelect').addEventListener('change', function() {
            currentFont = this.value;
            draw();
        });

        // Mengubah warna teks
        document.getElementById('colorSelect').addEventListener('input', function() {
            currentColor = this.value;
            draw();
        });

        // Men-download Twibbon
        function downloadImage() {
            const link = document.createElement('a');
            link.download = 'twibbon_hd.png';
            link.href = canvas.toDataURL('image/png', 1.0); // kualitas tinggi dengan resolusi HD
            link.click();
        }
    </script>
</body>
</html>
